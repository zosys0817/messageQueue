---
name: plan-review
description: 작성된 계획서를 여러 전문가 관점에서 리뷰합니다. ExitPlanMode 실행 후 CLAUDE.md 규칙에 따라 자동 실행됩니다. 계획서 검토, 설계 검증, 리뷰 요청 시에도 활성화됩니다.
---

# Plan Review

작성된 계획서를 여러 전문가 관점에서 리뷰합니다.

---

## 리뷰 절차

### Step 1: 계획서 읽기

1. 인자가 없으면 `.claude/plans/` 디렉토리에서 최신 파일 찾기
2. 계획서 전체 내용 읽기
3. 구조 파악 (엔드포인트, 데이터 모델, 구현 순서 등)

---

### Step 2: 다중 전문가 관점 리뷰

**6명의 가상 전문가**가 각자의 관점에서 계획서를 검토합니다:

---

#### 👨‍💻 Backend Architect (백엔드 아키텍트)

**검토 항목:**
- 레이어 분리가 적절한가? (Router → Service → Repository)
- 의존성 방향이 올바른가?
- 확장성을 고려했는가?
- 기존 패턴과 일관성이 있는가?

**체크리스트:**
- [ ] Service/Repository 패턴 준수
- [ ] 순환 의존성 없음
- [ ] 단일 책임 원칙(SRP) 준수
- [ ] 적절한 추상화 수준

---

#### 🔒 Security Engineer (보안 엔지니어)

**검토 항목:**
- 인증/인가가 적절히 설계되었는가?
- 입력 검증이 충분한가?
- 민감 데이터 처리가 안전한가?
- OWASP Top 10 취약점 고려했는가?

**체크리스트:**
- [ ] 인가 매트릭스 정의됨
- [ ] 모든 엔드포인트에 인증 요구사항 명시
- [ ] 입력 검증 포인트 정의
- [ ] SQL Injection 방지 (ORM 사용)
- [ ] XSS 방지 (출력 이스케이프)
- [ ] 민감 정보 로깅 금지
- [ ] Rate Limiting 적용
- [ ] CSRF/CORS 고려

---

#### 🧪 QA Engineer (품질 엔지니어)

**검토 항목:**
- 테스트 전략이 충분한가?
- 엣지 케이스를 고려했는가?
- 에러 케이스가 정의되었는가?
- TDD 원칙을 따르는가?

**체크리스트:**
- [ ] 단위 테스트 계획 있음
- [ ] 통합 테스트 계획 있음
- [ ] 에러 케이스 정의됨
- [ ] 경계값 테스트 고려
- [ ] 테스트 우선 구현 순서
- [ ] 커버리지 목표 80% 명시

---

#### 📊 DBA (데이터베이스 관리자)

**검토 항목:**
- 데이터 모델이 적절한가?
- 쿼리 성능을 고려했는가?
- 인덱스 전략이 있는가?
- 트랜잭션 범위가 적절한가?
- 마이그레이션 계획이 있는가?

**체크리스트:**
- [ ] 기존 테이블 스키마와 일치
- [ ] 필요한 인덱스 정의
- [ ] N+1 쿼리 문제 고려
- [ ] 트랜잭션 경계 명확
- [ ] 데이터 정합성 보장
- [ ] 마이그레이션 계획 있음
- [ ] 롤백 전략 정의

---

#### 🚀 DevOps Engineer (데브옵스 엔지니어)

**검토 항목:**
- 배포 시 고려사항이 있는가?
- 모니터링/로깅이 충분한가?
- 환경 변수 관리가 적절한가?
- 성능 병목이 예상되는가?

**체크리스트:**
- [ ] 환경 변수 목록 정의
- [ ] 로깅 포인트 정의
- [ ] 로깅 금지 항목 명시
- [ ] 헬스체크 엔드포인트 고려
- [ ] 에러 알림 기준 정의
- [ ] 롤백 전략 고려

---

#### 📝 Technical Writer (기술 문서 작성자)

**검토 항목:**
- 계획서 구조가 명확한가?
- 누락된 섹션이 있는가?
- 모호한 표현이 있는가?

**체크리스트:**
- [ ] 개요 섹션 완비
- [ ] 엔드포인트 상세 명시
- [ ] 에러 케이스 정의
- [ ] 구현 순서 명확
- [ ] 체크리스트 포함

---

### Step 3: 리뷰 리포트 출력

```markdown
# Plan Review Report

## 📋 계획서 요약
- 파일: {plan_file_path}
- 도메인: {domain}
- 엔드포인트: N개

---

## 👨‍💻 Backend Architect Review

### 평가: ⭐⭐⭐⭐☆ (4/5)

**잘된 점:**
- ...

**개선 필요:**
- ...

**권장 사항:**
1. ...

---

## 🔒 Security Engineer Review

### 평가: ⭐⭐⭐☆☆ (3/5)

**잘된 점:**
- ...

**보안 취약점:**
- [CRITICAL] ...
- [HIGH] ...
- [MEDIUM] ...
- [LOW] ...

**필수 수정:**
1. ...

---

## 🧪 QA Engineer Review

### 평가: ⭐⭐⭐⭐⭐ (5/5)

**잘된 점:**
- ...

**추가 테스트 케이스:**
- ...

---

## 📊 DBA Review

### 평가: ⭐⭐⭐⭐☆ (4/5)

**잘된 점:**
- ...

**성능 우려:**
- ...

**인덱스 제안:**
- ...

**마이그레이션 검토:**
- ...

---

## 🚀 DevOps Engineer Review

### 평가: ⭐⭐⭐⭐☆ (4/5)

**잘된 점:**
- ...

**운영 고려사항:**
- ...

---

## 📝 Technical Writer Review

### 평가: ⭐⭐⭐⭐☆ (4/5)

**잘된 점:**
- ...

**문서 개선:**
- ...

---

## 📊 종합 평가

| 전문가 | 평가 | 주요 이슈 |
|--------|------|-----------|
| Backend Architect | ⭐⭐⭐⭐☆ | ... |
| Security Engineer | ⭐⭐⭐☆☆ | ... |
| QA Engineer | ⭐⭐⭐⭐⭐ | ... |
| DBA | ⭐⭐⭐⭐☆ | ... |
| DevOps Engineer | ⭐⭐⭐⭐☆ | ... |
| Technical Writer | ⭐⭐⭐⭐☆ | ... |

**종합 점수: X.X / 5.0**

---

## ✅ 필수 수정 사항 (Must Fix)

1. [CRITICAL] ...
2. [HIGH] ...

## ⚠️ 권장 수정 사항 (Should Fix)

1. [MEDIUM] ...
2. [LOW] ...

## 💡 개선 제안 (Nice to Have)

1. ...
2. ...

---

## 다음 단계

리뷰 결과를 반영하여:
1. 계획서 수정 (직접 수정 또는 `/api-plan` 재실행)
2. 구현 진행 (`/api-scaffold`)
```

---

## 트러블슈팅

### 계획서를 찾을 수 없음
1. `.claude/plans/` 디렉토리 확인
2. 파일 목록 확인: `ls -la .claude/plans/`
3. 계획서가 없으면 `/api-plan` 먼저 실행

### 계획서 형식이 잘못됨
1. `/api-plan`의 템플릿 형식 확인
2. 필수 섹션: 개요, 엔드포인트, 구현 순서
3. 템플릿에 맞게 수정

### 리뷰가 너무 오래 걸림
1. 계획서 크기가 큰 경우 도메인별로 분리 고려
2. 특정 전문가 관점만 요청: "보안 관점에서만 리뷰해줘"

### 리뷰 결과가 너무 엄격함
1. 프로젝트 단계 고려 (MVP vs Production)
2. Must Fix만 우선 반영
3. Nice to Have는 백로그로 관리

---

## 사용 예시

```bash
# 최근 계획서 리뷰
/plan-review

# 특정 계획서 리뷰
/plan-review .claude/plans/products-api-plan.md

# 리뷰 후 수정하고 다시 리뷰
# (계획서 수정)
/plan-review
```

---

## 다음 단계

리뷰 완료 후:
1. 필수 수정 사항 반영
2. `/api-scaffold` - 코드 생성
